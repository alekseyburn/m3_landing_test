;(function() {
"use strict";function CustomValidation(e){this.invalidities=[],this.validityChecks=[],this.inputNode=e,this.registerListener()}function validate(){input.CustomValidation.checkInput()}var loadFile=function(e,i){var t=document.createElement("script"),n=function(){t.parentNode.removeChild(t),t=document.createElement("script"),t.type="text/javascript",t.src=i,document.getElementsByTagName("head")[0].appendChild(t)};t.type="text/javascript",t.src=e,t.onerror=n,document.getElementsByTagName("head")[0].appendChild(t)};/Trident.*rv:/.test(navigator.userAgent)&&(loadFile("//cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.3/picturefill.min.js","js/picturefill.min.js"),loadFile("//cdnjs.cloudflare.com/ajax/libs/svgxuse/1.2.6/svgxuse.min.js","js/svgxuse.min.js")),function(){var e=[window.Element,window.CharacterData,window.DocumentType],i=[];e.forEach(function(e){e&&i.push(e.prototype)}),function(e){e.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}(i)}(),CustomValidation.prototype={addInvalidity:function(e){this.invalidities.push(e)},getInvalidities:function(){return this.invalidities.join(". \n")},checkValidity:function(e){for(var i=0;i<this.validityChecks.length;i++){var t=this.validityChecks[i].isInvalid(e);t&&this.addInvalidity(this.validityChecks[i].invalidityMessage);var n=this.validityChecks[i].element;n&&(t?(n.classList.add("invalid"),n.classList.remove("valid")):(n.classList.remove("invalid"),n.classList.add("valid")))}},checkInput:function(){if(this.inputNode.CustomValidation.invalidities=[],this.checkValidity(this.inputNode),0===this.inputNode.CustomValidation.invalidities.length&&""!==this.inputNode.value)this.inputNode.setCustomValidity("");else{var e=this.inputNode.CustomValidation.getInvalidities();this.inputNode.setCustomValidity(e)}},registerListener:function(){var e=this;this.inputNode.addEventListener("keyup",function(){e.checkInput()})}};var mailValidityChecks=[{isInvalid:function(e){return!e.value.match(/@/g)},invalidityMessage:'Необходим символ "@"',element:document.querySelector(".form__requirements li:nth-child(1)")},{isInvalid:function(e){return!e.value.match(/^([a-z\d\-]+)@/g)},invalidityMessage:'Часть адреса перед "@"',element:document.querySelector(".form__requirements li:nth-child(2)")},{isInvalid:function(e){return!e.value.match(/@([a-z\d\-]+)/g)},invalidityMessage:'Часть адреса после "@"',element:document.querySelector(".form__requirements li:nth-child(3)")},{isInvalid:function(e){return!e.value.match(/@([a-z\d\-]+)\./g)},invalidityMessage:'Наличие "." перед доменом',element:document.querySelector(".form__requirements li:nth-child(4)")},{isInvalid:function(e){return!e.value.match(/@([a-z\d\-]+)\.([a-z]{2,8})(\.[a-z]{2,8})?$/g)},invalidityMessage:'Наличие домена после "."',element:document.querySelector(".form__requirements li:nth-child(5)")}],mailInput=document.querySelector(".form__field");mailInput.CustomValidation=new CustomValidation(mailInput),mailInput.CustomValidation.validityChecks=mailValidityChecks;var input=document.querySelector('input:not([type="submit"])'),submit=document.querySelector(".form__send-button"),form=document.querySelector(".form"),requirements=document.querySelector(".form__requirements");submit.addEventListener("click",validate),form.addEventListener("submit",validate),form.addEventListener("focusin",function(){requirements.classList.remove("non-visible"),requirements.classList.add("visible")}),form.addEventListener("focusout",function(){requirements.classList.add("non-visible"),requirements.classList.remove("visible")}),submit.addEventListener("click",function(e){if(input.checkValidity()){e.preventDefault();var i=document.createElement("p");i.innerHTML="Успешно отправлено",i.classList.add("success"),form.insertAdjacentElement("beforeend",i),setTimeout(function(){return i.remove()},2e3)}});
}());
